<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Cristhian Paredes and Jesús Ágreda" />

<meta name="date" content="2020-05-23" />

<title>labsimplex package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 800px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 20px;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 0;
padding: 4px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table:not([class]) {
margin: auto;
min-width: 40%;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table[summary="R argblock"] {
width: 100%;
border: none;
}
table:not([class]) th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table:not([class]) td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table:not([class]), table:not([class]) th, table:not([class]) td {
border-left-style: none;
border-right-style: none;
}
table:not([class]) tr.odd {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 13px;
padding-bottom: 1px;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f5f5f5;
border-radius: 3px;
color: #333;
}
pre {
overflow-x: auto;
border-radius: 3px;
margin: 5px 0 10px 0;
padding: 10px;
}
pre:not([class]) {
background-color: white;
border: #f5f5f5 1px solid;
}
pre:not([class]) code {
color: #444;
background-color: white;
}
code {
font-family: monospace;
font-size: 90%;
}
p > code, li > code {
padding: 2px 4px;
color: #d14;
border: 1px solid #e1e1e8;
white-space: inherit;
}
div.figure {
text-align: center;
}
table > caption, div.figure p.caption {
font-style: italic;
}
table > caption span, div.figure p.caption span {
font-style: normal;
font-weight: bold;
}
p {
margin: 0 0 10px;
}
table:not([class]) {
margin: auto auto 10px auto;
}
img:not([class]) {
background-color: #FFFFFF;
padding: 2px;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
max-width: 100%;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f5f5f5;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f5f5f5;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f5f5f5;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }
div.r-help-page {
background-color: #f9f9f9;
border-bottom: #ddd 1px solid;
margin-bottom: 10px;
padding: 10px;
}
div.r-help-page:hover {
background-color: #f4f4f4;
}

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">labsimplex package</h1>
<h4 class="author">Cristhian Paredes and Jesús Ágreda</h4>
<h4 class="date">2020-05-23</h4>


<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#using-the-package">Using the package</a>
<ul>
<li><a href="#generating-the-initial-simplex">Generating the initial simplex</a></li>
<li><a href="#simplex-graphical-representation">Simplex graphical representation</a></li>
<li><a href="#generating-new-vertices">Generating new vertices</a></li>
<li><a href="#repeat-until-satisfied">Repeat until satisfied</a></li>
</ul></li>
<li><a href="#response-surface-studied">Response surface studied</a></li>
<li><a href="#finding-the-nearest-local-optima">Finding the <em>nearest</em> local optima</a></li>
<li><a href="#noisy-response-surfaces">Noisy response surfaces</a>
<ul>
<li><a href="#exporting-and-importing-simplex-information">Exporting and importing simplex information</a></li>
</ul></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<p>The R package <code>labsimplex</code> implements the simplex optimization algorithms firstly proposed by <span class="citation">Spendley, Hext, and Himsworth (1962)</span> and later modified by <span class="citation">Nelder and Mead (1965)</span> for laboratory and production processes improvement. Tools for visualizing the coordinates of the experimental variables and the evolution in the response are provided. This package is not intended for linear programming applications (you can use <code>optimsimplex</code> package <span class="citation">(<span class="citeproc-not-found" data-reference-id="optimsimplex"><strong>???</strong></span>)</span> for this purpuse).</p>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>A simplex is the simplest polyhedron than can be built in a <em>n</em>-dimensional space (e.g. in two and three-dimensional spaces, the simplices are the well-known triangle and tetrahedron, respectively). To easily understand simplex algorithm a geometric abstraction is made necessary. The <em>n</em> input variables that may affect the result of a given process are seen as dimensions in a <em>n</em>-dimensional space. The set of <em>n</em> values that define the variables in a given experiment defines a <em>vertex</em>. A vertex represents an experiment that must be performed in the conditions described for its coordinates to get a response.</p>
<p>Every simplex in a <em>n</em>-dimensional space must have <em>n+1</em> vertices. If an object only has <em>n</em> vertices in a <em>n</em>-dimensional space, it will describe a subspace called hyperplane. For example, while in three-dimensional spaces a hyperplane is a <em>traditional</em> (two-dimensional) plane, in a two-dimensional space, a hyperplane will be defined by a (one-dimensional) line. The simplices must have a non-zero hypervolume (<em>n</em>-dimensional generalization of the space occupied by a body in a <em>n</em>-dimensional space). Given the restriction concerning the number of vertexes in a simplex, all the hyperfaces (<em>n</em>-dimensional generalization of a face) defined by any subset of <em>n</em> vertices must rely on differents hyperplanes.</p>
<p>The fixed step size simplex algorithm first introduced by <span class="citation">(<span class="citeproc-not-found" data-reference-id="Spendley"><strong>???</strong></span>)</span> is based on the idea that getting away from the zone that yields the worst results will provide a close up to the optimal zone. An initial simplex is defined and the experiments are performed to obtain a response for each vertex. After the responses have been obtained a new vertex is proposed based on the reflection of the simplex and this reflection is made based on the performance of the experiments. This new vertex provides a new experiment that must be performed and is likely to yield a better response as long as xit is supposed to be closer to the optimum zone. Once the optimum zone is reached, the simplex reflection movements will start to sistematically give vertex coordinates that coincide with already performed experiments (i.e. the simplex starts to spin). For a better understanding of the principles and the calculations behind the algorithm, see <span class="citation">(<span class="citeproc-not-found" data-reference-id="simplexbook"><strong>???</strong></span>)</span>.</p>
<p>A more dynamic simplex algorithm includes variable step size movements: expansions and two different kinds of contractions <span class="citation">(<span class="citeproc-not-found" data-reference-id="Nelder"><strong>???</strong></span>)</span>. This variation is known as the <em>variable-size</em> or <em>modified simplex algorithm</em> while the above described is referred to as the <em>fixed-size simplex algorithm</em>. The size in each movement is selected based on the previous vertices responses. The purpose in this variation is to reach the optimum zone more quickly and, once the optimum zone has been reached, contract the zone of study into a smaller area. This smaller area provides a closer view of the optimum zone. The final result is a vertex that is closer to the actual optimal set of variables than the one obtainable using the fixed-size algorithm. A deeper description can be found in <span class="citation">(<span class="citeproc-not-found" data-reference-id="simplexbook"><strong>???</strong></span>)</span>.</p>
<p>The <code>labsimplex</code> package is not intended to be used in linear programming optimizations. For this purpose use the <code>optimsimplex</code> package from <span class="citation">(<span class="citeproc-not-found" data-reference-id="optimsimplex"><strong>???</strong></span>)</span>.</p>
</div>
<div id="installation" class="section level2">
<h2>Installation</h2>
<p>For installing the last built version of labsimplex, use <code>install_github()</code> function from <code>devtools</code> package <span class="citation">(<span class="citeproc-not-found" data-reference-id="devtools"><strong>???</strong></span>)</span>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>devtools<span class="op">:</span><span class="kw">install_github</span>(<span class="st">&quot;Crparedes/labsimplex&quot;</span>)</span></code></pre></div>
</div>
<div id="using-the-package" class="section level2">
<h2>Using the package</h2>
<p>As in many optimization processes and experimental designs, the first step is to define the response (or responses) to optimize, the variables to study, and the initial values for those variables. Also, an adequated stepsize (i.e. initial range) for each variable must be defined. One of the advantages of the simplex algorithm over more widespread optimization protocols (e.g. fractional factorial designs), is that the inclusion of more variables to study does not significantly increase the number of experiments to be performed, making the initial variable screening process usually unnecessary. Once those decisions had been made, the experimenter will be able to generate the initial simplex coordinates and perform the experiments. The optimization using <code>labsimplex</code> package involves the following steps that will be further discussed:</p>
<ol style="list-style-type: decimal">
<li>Generate the initial simplex.</li>
<li>Export the simplex information to ensure the information will not be lost if the R session is restarted.</li>
<li>Perform the experiments described by the new vertices coordinates and obtain their response.</li>
<li>Import the file created in the second step.</li>
<li>Generate the new vertex to be evaluated.</li>
<li>Repeat steps 2 to 5 until the desired response is obtained</li>
</ol>
<p>If the experiments do not take long the response may be obtained quickly and the process could be optimized in a single R session. In this case, steps that include exporting and importing files are not necessary. The simplex coordinates may be plotted in any stage of the process but if the simplex has high dimensionality (n &gt; 3), the plot will provide a mere projection of selected variables.</p>
<div id="generating-the-initial-simplex" class="section level3">
<h3>Generating the initial simplex</h3>
<p>New simplex objects are generated using the function <code>labsimplex()</code>. The only not optional parameter is N which relates to the dimensionality of the simplex. If just N is provided, a regular simplex centered at the origin will be generated. For example, to create a regular simplex object of three dimensions use:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>ExpSet &lt;-<span class="st"> </span><span class="kw">labsimplex</span>(<span class="dt">N =</span> <span class="dv">3</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">print</span>(ExpSet)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#&gt; </span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">#&gt; Current simplex:</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">#&gt;                Var.1      Var.2      Var.3 . Response Label Nature</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">#&gt; Vertex.4: -0.3333333 -0.4714045 -0.8164966 |       NA    NA      S</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">#&gt; Vertex.3: -0.3333333 -0.4714045  0.8164966 |       NA    NA      S</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">#&gt; Vertex.2: -0.3333333  0.9428090  0.0000000 |       NA    NA      S</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co">#&gt; Vertex.1:  1.0000000  0.0000000  0.0000000 |       NA    NA      S</span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co">#&gt; </span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">#&gt; Conventions:</span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co">#&gt;     Labels:                    Nature:</span></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co">#&gt;        W: Worst or Wastebasket    S:  Starting</span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co">#&gt;        N: Next to the worst       R:  Reflected</span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="co">#&gt;        B: Best                    E:  Expanded</span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="co">#&gt;                                   Cr: Contraction on the reflection side</span></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="co">#&gt;        D: Disregarded             Cw: Contraction on the worst side</span></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co">#&gt; </span></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="co">#&gt;       Use print(..., conventions = FALSE) to disable conventions printing.</span></span></code></pre></div>
<p>The function output consists of three sections. The first one contains the current simplex vertices information, the second section (not shown here as it only appears when more vertices have been obtained) has the <em>historical</em> vertices information and the third section shows the conventions used in the first two sections. The conventions printing may be disabled using <code>print(..., conventions = FALSE)</code>. The vertices information includes an identification (Vertex.##), the coordinates for each of its N variables, the response obtained for that vertex, the label (indicating if it corresponds to the best, next to the worst and worst or wastebasket vertex) and its nature (indicating if the vertex was introduced as a point in the initial simplex or generated as a reflection, expansion or contraction of the previous simplex).</p>
<p>The coordinates of this default regular simplex lay in a dimensionless abstract space that does not correlate actual values for the experimental variables. Generating a simplex in the real variables space will require a positioning reference and a step size for each dimension. Two references are possible for positioning: the coordinates of the first experiment or the simplex centroid (i.e. gravity center). The step size and the first experiment (or simplex centroid) coordinates must be given as numeric vectors having a value for each variable. The first experiment coordinates and the centroid are incompatible parameters. Just one can be provided at the parameters <code>start</code> or <code>centroid</code>, respectively. The stepsize may be provided in the <code>stepsize</code> parameter. Variable names may be specified as a character vector in the <code>var.name</code> parameter. The equivalent usage of the mentioned parameters is shown below.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>ExpSet &lt;-<span class="st"> </span><span class="kw">labsimplex</span>(<span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">7</span>, <span class="dv">25</span>, <span class="fl">0.15</span>), <span class="dt">stepsize =</span> <span class="kw">c</span>(<span class="fl">0.2</span>, <span class="dv">5</span>, <span class="fl">0.02</span>), </span>
<span id="cb3-2"><a href="#cb3-2"></a>                     <span class="dt">var.name =</span> <span class="kw">c</span>(<span class="st">&#39;pH&#39;</span>, <span class="st">&#39;Temp&#39;</span>, <span class="st">&#39;Conc&#39;</span>))</span>
<span id="cb3-3"><a href="#cb3-3"></a>ExpSet &lt;-<span class="st"> </span><span class="kw">labsimplex</span>(<span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">centroid =</span> <span class="kw">c</span>(<span class="fl">6.85</span>, <span class="dv">25</span>, <span class="fl">0.15</span>), <span class="dt">stepsize =</span> <span class="kw">c</span>(<span class="fl">0.2</span>, <span class="dv">5</span>, <span class="fl">0.02</span>), </span>
<span id="cb3-4"><a href="#cb3-4"></a>                     <span class="dt">var.name =</span> <span class="kw">c</span>(<span class="st">&#39;pH&#39;</span>, <span class="st">&#39;Temp&#39;</span>, <span class="st">&#39;Conc&#39;</span>))</span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="kw">print</span>(ExpSet)</span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">#&gt; </span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">#&gt; Current simplex:</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">#&gt;            pH     Temp Conc . Response Label Nature</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">#&gt; Vertex.4: 6.8 23.33333 0.14 |       NA    NA      S</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co">#&gt; Vertex.3: 6.8 23.33333 0.16 |       NA    NA      S</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co">#&gt; Vertex.2: 6.8 28.33333 0.15 |       NA    NA      S</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co">#&gt; Vertex.1: 7.0 25.00000 0.15 |       NA    NA      S</span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co">#&gt; </span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co">#&gt; Conventions:</span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="co">#&gt;     Labels:                    Nature:</span></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="co">#&gt;        W: Worst or Wastebasket    S:  Starting</span></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="co">#&gt;        N: Next to the worst       R:  Reflected</span></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="co">#&gt;        B: Best                    E:  Expanded</span></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="co">#&gt;                                   Cr: Contraction on the reflection side</span></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="co">#&gt;        D: Disregarded             Cw: Contraction on the worst side</span></span>
<span id="cb3-21"><a href="#cb3-21"></a><span class="co">#&gt; </span></span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="co">#&gt;       Use print(..., conventions = FALSE) to disable conventions printing.</span></span></code></pre></div>
<div id="manually-defining-the-initial-vertices-coordinates" class="section level5">
<h5>Manually defining the initial vertices coordinates</h5>
<p>If the experimenter wants to manually define all the variable values for each vertex in the initial simplex, those coordinates must be in a matrix containing in N+1 rows the N coordinates of each vertex. The matrix is used in the <code>usrdef</code> parameter of the <code>labsimplex()</code> function. This parameter is incompatible with the centroid, stepsize and the start parameters.</p>
<p>Setting the vertex coordinates manually is prone to error due to the odds of setting two hyperfaces in the same hyperplane. A so defined simplex will have zero hypervolume and it is said to be <em>degenerated.</em> A degenerated simplex would not be able to move to the optimal zone. The probability of this issue grows up with the number of variables as the dimensional space gets more difficult to visualize. If given coordinates define a simplex with a non-zero hypervolume, the function will print <code>Provided points define a simplex</code>. If it is not the case, an error indicating the situation is obtained. The next example shows how it works.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>ExpMtrx &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="fl">7.1</span>, <span class="dv">25</span>, <span class="fl">0.15</span>), <span class="kw">c</span>(<span class="fl">6.9</span>, <span class="dv">28</span>, <span class="fl">0.15</span>), <span class="kw">c</span>(<span class="fl">6.9</span>, <span class="dv">23</span>, <span class="fl">0.16</span>), <span class="kw">c</span>(<span class="fl">6.9</span>, <span class="dv">23</span>, <span class="fl">0.14</span>))</span>
<span id="cb4-2"><a href="#cb4-2"></a>ManSet &lt;-<span class="st"> </span><span class="kw">labsimplex</span>(<span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">usrdef =</span> ExpMtrx, <span class="dt">var.name =</span> <span class="kw">c</span>(<span class="st">&#39;pH&#39;</span>, <span class="st">&#39;Temp&#39;</span>, <span class="st">&#39;Conc&#39;</span>))</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">#&gt; Provided points define a simplex:</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="kw">print</span>(ManSet)</span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">#&gt; </span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co">#&gt; Current simplex:</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co">#&gt;            pH Temp Conc . Response Label Nature</span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">#&gt; Vertex.4: 6.9   23 0.14 |       NA    NA      S</span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co">#&gt; Vertex.3: 6.9   23 0.16 |       NA    NA      S</span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co">#&gt; Vertex.2: 6.9   28 0.15 |       NA    NA      S</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co">#&gt; Vertex.1: 7.1   25 0.15 |       NA    NA      S</span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co">#&gt; </span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co">#&gt; Conventions:</span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="co">#&gt;     Labels:                    Nature:</span></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="co">#&gt;        W: Worst or Wastebasket    S:  Starting</span></span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="co">#&gt;        N: Next to the worst       R:  Reflected</span></span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="co">#&gt;        B: Best                    E:  Expanded</span></span>
<span id="cb4-18"><a href="#cb4-18"></a><span class="co">#&gt;                                   Cr: Contraction on the reflection side</span></span>
<span id="cb4-19"><a href="#cb4-19"></a><span class="co">#&gt;        D: Disregarded             Cw: Contraction on the worst side</span></span>
<span id="cb4-20"><a href="#cb4-20"></a><span class="co">#&gt; </span></span>
<span id="cb4-21"><a href="#cb4-21"></a><span class="co">#&gt;       Use print(..., conventions = FALSE) to disable conventions printing.</span></span></code></pre></div>
<div id="screening-experimental-desings-integration" class="section level6">
<h6>Screening experimental desings integration</h6>
<p>When a two-level fractional factorial design has already be done in the variables screening process, those experiments may be used as the user-defined coordinates for the initial vertex. These experimental designs are capable of studying N variables in N+1 experiments. One advantage is that the experiments are already performed and their response is, in principle, available. At this point, the algorithm is ready to propose a new closer-to-the-optimum vertex.</p>
<p>For example, suppose the variables pH, temperature and concentration in the previous example had been <em>screened</em> using a two-level fractional factorial design of resolution III. The R package <code>FrF2</code> <span class="citation">(<span class="citeproc-not-found" data-reference-id="FrF2"><strong>???</strong></span>)</span> creates fractional factorial 2-level designs and will be used here. The low and high levels for the pH, the temperature and the concentration will be 6.9 and 7.1, 23 and 28°C and 0.14 and 0.16 mol L<span class="math inline">\(^{-1}\)</span> respectively.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">suppressMessages</span>(<span class="kw">library</span>(FrF2))</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a>screening &lt;-<span class="st"> </span><span class="kw">FrF2</span>(<span class="dt">resolution =</span> <span class="dv">3</span>, <span class="dt">nfactors =</span> <span class="dv">3</span>, </span>
<span id="cb5-4"><a href="#cb5-4"></a>                  <span class="dt">factor.names =</span> <span class="kw">list</span>(<span class="dt">pH =</span> <span class="kw">c</span>(<span class="fl">6.9</span>, <span class="fl">7.1</span>), </span>
<span id="cb5-5"><a href="#cb5-5"></a>                                      <span class="dt">Temp =</span> <span class="kw">c</span>(<span class="dv">23</span>, <span class="dv">28</span>), </span>
<span id="cb5-6"><a href="#cb5-6"></a>                                      <span class="dt">Conc =</span> <span class="kw">c</span>(<span class="fl">0.14</span>, <span class="fl">0.16</span>)))</span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="kw">print</span>(screening)</span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">#&gt;    pH Temp Conc</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">#&gt; 1 6.9   23 0.16</span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co">#&gt; 2 6.9   28 0.14</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co">#&gt; 3 7.1   28 0.16</span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co">#&gt; 4 7.1   23 0.14</span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="co">#&gt; class=design, type= FrF2</span></span></code></pre></div>
<p>The variable coordinates and the names can be passed to the labsimplex function after little transformation:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>FrF2Set &lt;-<span class="st"> </span><span class="kw">labsimplex</span>(<span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">usrdef =</span> <span class="kw">matrix</span>(<span class="kw">as.numeric</span>(<span class="kw">as.matrix</span>(screening)), <span class="dt">ncol =</span> <span class="dv">3</span>),</span>
<span id="cb6-2"><a href="#cb6-2"></a>                      <span class="dt">var.name =</span> <span class="kw">dimnames</span>(screening)[[<span class="dv">2</span>]])</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">#&gt; Provided points define a simplex:</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="kw">print</span>(FrF2Set)</span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">#&gt; </span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co">#&gt; Current simplex:</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co">#&gt;            pH Temp Conc . Response Label Nature</span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co">#&gt; Vertex.4: 7.1   23 0.14 |       NA    NA      S</span></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="co">#&gt; Vertex.3: 7.1   28 0.16 |       NA    NA      S</span></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="co">#&gt; Vertex.2: 6.9   28 0.14 |       NA    NA      S</span></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co">#&gt; Vertex.1: 6.9   23 0.16 |       NA    NA      S</span></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="co">#&gt; </span></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="co">#&gt; Conventions:</span></span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="co">#&gt;     Labels:                    Nature:</span></span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="co">#&gt;        W: Worst or Wastebasket    S:  Starting</span></span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="co">#&gt;        N: Next to the worst       R:  Reflected</span></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="co">#&gt;        B: Best                    E:  Expanded</span></span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="co">#&gt;                                   Cr: Contraction on the reflection side</span></span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="co">#&gt;        D: Disregarded             Cw: Contraction on the worst side</span></span>
<span id="cb6-20"><a href="#cb6-20"></a><span class="co">#&gt; </span></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="co">#&gt;       Use print(..., conventions = FALSE) to disable conventions printing.</span></span></code></pre></div>
<p>The <em>little</em> modifications will depend on the R-package used for the screening experimental design. If some variables were of no statistical importance or the fractional experiment design had a resolution higher than three, there will be a surplus number of experiments. Again, we will have a non-zero probability of mischoosing the coordinates that would lead us to an error. The election must be carefully made but the function will notice if an incorrect set of coordinates is given.</p>
</div>
</div>
<div id="modifying-vertex-coordinates" class="section level5">
<h5>Modifying vertex coordinates</h5>
<p>Sometimes, it is practically impossible to accurately set a particular value for a variable in the actual experiment (e.g. weighing the mass of a high viscosity liquid that is used in very small amounts in a chemical reaction or fine tunning of pH in an unbuffered media). The next vertex may be more suitable if it is calculated using the actual coordinates of the experiments performed rather than the <em>ideal</em> coordinates proposed by the package. Most of the time this can be ignored but if this is not the case, vertex coordinates can be manually adjusted using the <code>modifyVertex()</code> function. This function allows modifying as many variables in as many vertices as needed and must be used before generating a new vertex.</p>
<p>Suppose we need to change the pH of the first vertex to 7.15 and the temperature of the second vertex to 29. The changes are given in a list containing numeric vectors of length N and the new values in the respective position of the corresponding variable. Other positions must have <code>NA</code> values.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co">#adjustVertex(simplex = ManSet, newcoords = list(Vertex.1 = c(7.15, NA, NA), </span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co">#                                                Vertex.2 = c(NA, 29, NA)),</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">#             overwrite = TRUE)</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co">#print(ManSet)</span></span></code></pre></div>
</div>
</div>
<div id="simplex-graphical-representation" class="section level3">
<h3>Simplex graphical representation</h3>
<p>The simplex may be visualized in a three-dimensional plot using <code>plotSimplex3D()</code> function. This function plots simplex coordinates when its dimensionality is at least three. When dimensionality is higher than three, variables to be plotted can be specified as the function will only project three variables. Selected variables can be indicated as a character vector of length 3 using <code>sel.dim</code> parameter, the elements of the vector must coincide with three of the variable names available in the simplex. A numeric vector indicating the columns of the selected variables is also accepted but not highly recommended. If no variables are indicated, the function will plot the first three ones by default.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co">#plotSimplex3D(ExpSet)</span></span></code></pre></div>
<p>In a very similar way, a two-dimensional projection of the simplex object may be plotted using <code>plot()</code> function. As the simplex dimensionality is in our case, higher than two, the dimensions to be represented can be specified and the projected image of the simplex will change depending on the selected variables.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">#par(mfrow = c(1, 3))</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co">#plot(ExpSet, sel.dim = c(&#39;pH&#39;, &#39;Temp&#39;))</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">#plot(ExpSet, sel.dim = c(&#39;pH&#39;, &#39;Conc&#39;))</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">#plot(ExpSet, sel.dim = c(&#39;Temp&#39;, &#39;Conc&#39;))</span></span></code></pre></div>
<p>Here, it becomes obvious that different variables projection produces quite different images. Some of the combinations of the variables would have overlapping vertices that may lead to confusion when reviewing the simplex graphical representation and must be addressed carefully.</p>
</div>
<div id="generating-new-vertices" class="section level3">
<h3>Generating new vertices</h3>
<p>New vertices are generated using the response values for each vertex of the previous simplex, the optimization criteria and the algorithm (fixed-size or variable-size) chosen. The function required is <code>generateVertex()</code>.</p>
<p>In the previous example, suppose that vertices 1 to 4 had responses of 65, 72, 54 and 78 respectively. Here, the fixed-size simplex algorithm is used and the purpose of the optimization is to maximize the response. Those are the default settings at the <code>generateVertex()</code> function. The response of the vertices for the initial simplex vertices must be supplied in ascendant order (vertex.1, vertex.2, …). After this, to generate a new vertex, just the response of the last generated vertex will be needed.</p>
<p>The function output is a simplex object containing all the information of the previous one adding the new vertex coordinates. Replotting the new simplex will show the result of the movement.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co">#generateVertex(simplex = ExpSet, qflv = c(65, 72, 54, 78), overwrite = TRUE)</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co">#plotSimplex3D(ExpSet)</span></span></code></pre></div>
<p>The <code>generateVertex()</code> function can be used just for visualizing the coordinates of the new vertex to be evaluated. Since the new vertex coordinates integrate now one of the points of the new simplex, the recommended action is to save the function output to an object that could be completely new in the environment or to overwrite the original one. Usually, while looking for a clean environment and considering that the new simplex object contains all the information of the previous one, overwriting the original object is the best option. This is easily achieved by using <code>overwrite = TRUE</code> in the function parameters.</p>
<p>The optimization criteria, the <code>crit</code> parameter, can be set to search for a maximum <code>&#39;max&#39;</code> (default), a minimum <code>&#39;min&#39;</code> or to a numerical value. The simplex will move in the direction in which the response value grows, decreases or approaches to the given numerical value, respectively.</p>
<p>The simplex optimization algorithm is flexible and the simplex can change between fixed-size and variable-size alternatives at any time. This is done by using <code>algor = &#39;fixed&#39;</code> (default) and <code>algor = &#39;variable&#39;</code> in the <code>generateVertex()</code> function. The next vertex to be evaluated is generated according to the selected algorithm.</p>
</div>
<div id="repeat-until-satisfied" class="section level3">
<h3>Repeat until satisfied</h3>
<p>The simplex optimization may proceed until a maximum is achieved or satisfactory response is reached. The former will depend on the algorithm that is being followed and the later may represent a very time-saving strategy as the simplex optimization algorithm may lose some power near the optimum zone. Some other methods may lead to richer system information in that zone (e.g. response surface experimental designs).</p>
<p>The response value can be plotted against the vertex number using the function <code>plotSimplexResponse()</code>.</p>
<p>When the optimum zone in the fixed-size simplex algorithm is reached, the simplex will start to <em>spin</em> around the vertex that had a better response. This may be easy to notice in low dimension simplex by looking at the graphical representation of the simplex. The simplex had found the optimal zone but there is no warranty that the best vertex sits at the best possible coordinates since the optimal point may lay between the vertices of the spinning simplices. This would be a good moment for changing to the variable-size option.</p>
<p>In the variable size algorithm, the simplex will contract into the optimal point indefinitely until variations became so small that it is practically impossible (or simply inconvenient from a practical point of view) to experimentally differentiate two vertices. The constant contracting simplex may indicate the optimal point of the space but the obtained responses may lack information about how robust is the experiment in that zone. A highly focused (studying a small range for the variables) surface response methodology could be of great utility in obtaining the predicted optimal point plus giving information about the robustness of the system in that zone.</p>
</div>
</div>
<div id="response-surface-studied" class="section level2">
<h2>Response surface studied</h2>
<p>The response surface below is</p>
</div>
<div id="finding-the-nearest-local-optima" class="section level2">
<h2>Finding the <em>nearest</em> local optima</h2>
</div>
<div id="noisy-response-surfaces" class="section level2">
<h2>Noisy response surfaces</h2>
<div id="exporting-and-importing-simplex-information" class="section level3">
<h3>Exporting and importing simplex information</h3>
<p>In some cases, each experiment could take up to several days being performed. The optimization information must be safely stored in the case that the R session is finished without saving the workspace image. Using scripts with the complete process may be a good alternative but for those wanting a more secure way or those who use a simplex algorithm as a never-ending evolutive optimization, the <code>simplexExport()</code> function will create a plain text file with <code>.smplx</code> extension. This file contains all the simplex information. The file must not be edited by hand since it may produce misoperation of some package functions and in the worst case, the information may get lost.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">simplexExport</span>(ExpSet)</span></code></pre></div>
<p>The <code>simplexImport()</code> function creates a simplex object using the information contained into a <code>.smplx</code> file. The file extension must be included and the name of the created object may be specified or automatically created.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">simplexImport</span>(<span class="st">&#39;ExpSet&#39;</span>, <span class="dt">name =</span> <span class="st">&#39;importedSimplex&#39;</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="kw">print</span>(importedSimplex)</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co">#&gt; </span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co">#&gt; Current simplex:</span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co">#&gt;            pH     Temp Conc . Response Label Nature</span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="co">#&gt; Vertex.4: 6.8 23.33333 0.14 |       NA    NA      S</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="co">#&gt; Vertex.3: 6.8 23.33333 0.16 |       NA    NA      S</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="co">#&gt; Vertex.2: 6.8 28.33333 0.15 |       NA    NA      S</span></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="co">#&gt; Vertex.1: 7.0 25.00000 0.15 |       NA    NA      S</span></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="co">#&gt; </span></span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="co">#&gt; Conventions:</span></span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="co">#&gt;     Labels:                    Nature:</span></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="co">#&gt;        W: Worst or Wastebasket    S:  Starting</span></span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="co">#&gt;        N: Next to the worst       R:  Reflected</span></span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="co">#&gt;        B: Best                    E:  Expanded</span></span>
<span id="cb12-16"><a href="#cb12-16"></a><span class="co">#&gt;                                   Cr: Contraction on the reflection side</span></span>
<span id="cb12-17"><a href="#cb12-17"></a><span class="co">#&gt;        D: Disregarded             Cw: Contraction on the worst side</span></span>
<span id="cb12-18"><a href="#cb12-18"></a><span class="co">#&gt; </span></span>
<span id="cb12-19"><a href="#cb12-19"></a><span class="co">#&gt;       Use print(..., conventions = FALSE) to disable conventions printing.</span></span></code></pre></div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references hanging-indent">
<div id="ref-Nelder1965">
<p>Nelder, J. A., and R. Mead. 1965. “A Simplex Method for Function Minimization.” <em>The Computer Journal</em> 7 (4): 308–13. <a href="https://doi.org/10.1093/comjnl/7.4.308">https://doi.org/10.1093/comjnl/7.4.308</a>.</p>
</div>
<div id="ref-Spendley1962">
<p>Spendley, W., G. R. Hext, and F. R. Himsworth. 1962. “Sequential Application of Simplex Designs in Optimisation and Evolutionary Operation.” <em>Technometrics</em> 4 (4): 441–61. <a href="https://doi.org/10.1080/00401706.1962.10490033">https://doi.org/10.1080/00401706.1962.10490033</a>.</p>
</div>
</div>
</div>

<script type="text/javascript">
window.onload = function() {
  var i, fig = 1, caps = document.getElementsByClassName('caption');
  for (i = 0; i < caps.length; i++) {
    var cap = caps[i];
    if (cap.parentElement.className !== 'figure' || cap.nodeName !== 'P')
      continue;
    cap.innerHTML = '<span>Figure ' + fig + ':</span> ' + cap.innerHTML;
    fig++;
  }
  fig = 1;
  caps = document.getElementsByTagName('caption');
  for (i = 0; i < caps.length; i++) {
    var cap = caps[i];
    if (cap.parentElement.nodeName !== 'TABLE') continue;
    cap.innerHTML = '<span>Table ' + fig + ':</span> ' + cap.innerHTML;
    fig++;
  }
}
</script>


<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
